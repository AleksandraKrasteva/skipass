# apiVersion: apps/v1
# kind: Deployment
# metadata:
#   name: user-service-deployment
#   labels:
#     app: user-service
# spec:
#   replicas: 1
#   revisionHistoryLimit: 0
#   selector:
#     matchLabels:
#       app: user-service
#   template:
#     metadata:
#       labels:
#         app: user-service       
#     spec:
#       containers:
#         - name: user-service
#           image: ghcr.io/aleksandrakrasteva/user-service:dev
#           # image: ghcr.io/aleksandrakrasteva/user-service@sha256:a5618825b8c98454904e9c037a223bb19c17c9f29468953c20b79896580c6820
#           # image: ghcr.io/aleksandrakrasteva/user-service@sha256:2f91d31790571a208deee17ce16308d54279f705f37038e3bb81e91ebc96b6fb
#           imagePullPolicy: Always
#           ports: 
#           - containerPort: 8080
#           env:
#           - name: RABBITMQ_HOST
#             valueFrom:
#               configMapKeyRef:
#                 name: global-config
#                 key: rabbitmq-host
#           - name: RABBITMQ_PORT
#             valueFrom:
#               configMapKeyRef:
#                   name: global-config
#                   key: rabbitmq-port
#           - name: USER_DB_HOST
#             valueFrom:
#               configMapKeyRef:
#                 name: global-config
#                 key: user-db-host   
#           - name: USER_DB_PORT
#             valueFrom:
#               configMapKeyRef:
#                 name: global-config
#                 key:  user-db-port
#           - name: RABBITMQ_USER
#             valueFrom:
#               secretKeyRef:
#                   name: global-secret
#                   key: rabbitmq-user 
#           - name: RABBITMQ_PASS
#             valueFrom:
#               secretKeyRef:
#                 name: global-secret
#                 key: rabbitmq-pass   
#           - name: USER_DB_USER
#             valueFrom:
#               secretKeyRef:
#                 name: global-secret
#                 key: user-db-user
#           - name: USER_DB_PASS
#             valueFrom:
#               secretKeyRef:
#                 name: global-secret
#                 key: user-db-pass
#           securityContext:
#             allowPrivilegeEscalation: false
#           resources:
#             requests:
#               cpu: 250m
#               memory: "600Mi"
#             limits: 
#               cpu: 250m 
#               memory: "600Mi"

#           # horizontalPodAutoscaler:
#           #   minReplicas: 2
#           #   maxReplicas: 8
#           #   resources:
#           #     cpu:
#           #       type: Utilization
#           #       averageUtilization: 50
#           #     memory:
#           #       type: Utilization
#           #       averageUtilization: 50
#           #   metrics:
#           #     golang_sample_app_requests_per_second:
#           #       type: AverageValue
#           #       averageValue: 10
# ---
# apiVersion: v1
# kind: Service
# metadata:
#   name: user-service-service
# spec:
#   selector:
#     app: user-service
#   ports:
#     - protocol: TCP
#       port: 8080
#       targetPort: 8080